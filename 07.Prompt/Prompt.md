# 프롬프트(Prompt)

## 1. 프롬프트의 개념과 중요성

### 프롬프트란?
LLM에 제공하는 텍스트 입력으로, 모델이 문맥을 잘 이해하고 관련성 높은 응답을 생성할 수 있도록하는 지시문
프롬프트는 LLM과의 "대화"를 시작하는 방법이자, 모델의 답변을 조절하는 핵심 메커니즘

### 프롬프트의 중요성
- **모델의 방향성 결정**: 같은 LLM이라도 프롬프트에 따라 완전히 다른 응답 생성
- **RAG의 정확성 향상**: 검색된 정보를 효과적으로 활용하도록 안내
- **응답 품질 좌우**: 잘 설계된 프롬프트는 더 정확하고 유용한 응답 생성
- **환각 현상 감소**: 검색된 정보에 충실한 응답을 유도하여 환각 최소화

---

## 2. 프롬프트 설계 원칙

### 명확성과 구체성
- **명확한 지시**: 모델이 수행해야 할 작업을 정확히 명시
- **구체적인 형식**: 원하는 출력 형식 지정
- **단계별 안내**: 복잡한 작업을 단계별로 분해하여 안내

### 컨텍스트 제공
- **배경 정보**: 주제에 대한 관련 배경 정보 제공
- **고객 정의**: 주 사용 대상 고객을 명시하여 적절한 수준 조정
- **사용 목적**: 정보가 어떻게 활용될지 명시

### 예시 활용
- **Few-shot 학습**: 원하는 형식의 예시를 제공하여 모델 안내
- **다양한 예시**: 다양한 상황을 포괄하는 예시 제공
- **반례 제시**: 원치 않는 응답의 예를 보여주어 경계 설정

### 역할 부여
- **전문가 역할**: "당신은 [분야]의 전문가입니다"
- **인격화**: 특정 스타일이나 성격을 부여하여 일관성 확보

### 제약 설정
- **정보 범위 제한**: "제공된 정보만 사용하세요"
- **형식 제약**: 단어 수, 구조, 스타일 등의 제약 설정
- **불확실성 처리**: 확실하지 않은 정보에 대한 대응 방법 지정

---

## 3. 프롬프로 유형 

### 직접 프롬프트(Zero-Shot)

제로샷 프롬프팅은 가장 기본적인 접근 방식으로, 모델에 예시나 추가 맥락 없이 직접적인 지시나 질문 제공

**특징:**
- 간단하고 직접적인 명령 사용, 
- 추가 예시 없이 즉각적인 응답 요청
- 모델의 기본 능력에 의존

**활용 사례:**
- 간단한 정보 요청: "서울의 인구는 얼마인가요?"
- 단순한 문서 생성: "강아지를 주인공으로 한 짧은 이야기를 작성해주세요."
- 단순 번역/요약: "다음 텍스트를 영어로 번역해주세요."

**장점:** 빠르고 간단하게 사용
**단점:** 복잡한 작업이나 특정 형식이 필요한 경우 정확도가 떨어짐

### 원샷(One-Shot), 퓨샷(Few-Shot), 멀티샷(Multi-Shot) 프롬프트

모델에 하나 이상의 예시를 제공하여 원하는 출력 형식과 스타일 제공

**원샷 프롬프트:** 하나의 예시만 제공
```
입력: 오늘은 날씨가 좋다.
출력: Today, the weather is good.

입력: 내일 우리는 공원에 갈 것이다.
출력:
```

**퓨샷 프롬프트:** 몇 개의 예시 제공
```
입력: 피자가 맛있어요.
출력: The pizza is delicious.

입력: 음악을 듣는 것이 즐겁습니다.
출력: Listening to music is enjoyable.

입력: 그는 책을 읽고 있어요.
출력:
```

**멀티샷 프롬프트:** 많은 예시 제공 (일반적으로 5개 이상)

**장점:**
- 모델이 작업의 패턴을 더 정확히 이해
- 특정 출력 형식이나 스타일을 명확하게 제시 가능
- 복잡한 작업에서 더 일관된 결과 제공

**단점:**
- 더 긴 프롬프트 필요
- 예시 선택이 결과에 큰 영향 미침

### 연쇄적 사고(Chain of Thought, CoT) 프롬프트

모델이 복잡한 문제를 해결할 때 단계별로 추론 과정을 보여주도록 유도하는 방법

**특징:**
- 중간 추론 단계를 명시적으로 요청
- 논리적 사고 과정을 단계별로 분석
- 최종 답변으로 이어지는 사고 흐름 제시

**예시:**
```
질문: 철수는 사과 5개를 가지고 있었습니다. 영희에게 2개를 주고, 민수에게서 3개를 받았습니다. 
     철수는 지금 몇 개의 사과를 가지고 있나요?

단계별 사고:
1. 철수는 처음에 사과 5개가 있었습니다.
2. 영희에게 2개를 주었으므로 5 - 2 = 3개가 남았습니다.
3. 민수에게서 3개를 받았으므로 3 + 3 = 6개가 되었습니다.
4. 따라서 철수는 현재 사과 6개를 가지고 있습니다.
```

**장점:**
- 복잡한 수학 문제, 논리 퍼즐, 다단계 계획에 효과적
- 오류 발생 가능성 감소
- 사용자가 AI의 사고 과정을 이해하는 데 도움

### 제로샷 CoT 프롬프트

제로샷 CoT는 예시 없이도 모델에게 단계별 추론을 요청하는 방식입니다.

**특징:**
- 단순히 "단계별로 생각해봅시다" 같은 문구 추가
- 예시 없이도 추론 과정 유도 가능

**예시:**
```
질문: 한 옷 가게에서 셔츠는 15,000원, 바지는 25,000원입니다. 민지는 셔츠 2벌과 바지 1벌을 구매했습니다.
     10% 할인 쿠폰을 사용했다면, 민지가 지불한 총 금액은 얼마인가요? 
     단계별로 생각해봅시다.
```

**장점:**
- 원샷/퓨샷 예시 준비 시간 절약
- 간단한 프롬프트로 복잡한 추론 유도 가능

### 프롬프트 유형 선택 가이드

| 작업 유형 | 권장 프롬프트 유형 | 비고 |
|----------|-----------------|------|
| 간단한 정보 요청 | 제로샷 | 직접적인 질문이 효과적 |
| 특정 형식의 콘텐츠 생성 | 원샷/퓨샷 | 원하는 형식의 예시 제공 |
| 복잡한 수학/논리 문제 | CoT 또는 제로샷 CoT | 단계별 추론 과정 요청 |
| 창의적 글쓰기 | 퓨샷 | 원하는 스타일/톤의 예시 제공 |
| 분류 작업 | 멀티샷 | 다양한 카테고리 예시 제공 |


---

## 4. RAG 프롬프트의 구조

### 기본 구조
```
[시스템 지시]
[역할 정의]
[작업 설명]
[검색된 컨텍스트]
[사용자 질의]
[응답 형식 지정]
[제약 사항]
```

### 시스템 지시(System Instruction)
LLM에게 전반적인 동작 방식을 알려주는 최상위 지시

```
당신은 제공된 정보를 기반으로 정확하고 도움이 되는 응답을 제공하는 AI 어시스턴트입니다. 
제공된 정보에 명시되지 않은 내용은 추측하지 말고, 불확실한 경우 그렇다고 명시해야 합니다.
```

### 역할 정의(Role Definition)
모델이 취해야 할 역할을 명시

```
당신은 과학 문헌을 분석하는 연구 조교로, 최신 연구 결과를 이해하기 쉽게 설명해야 합니다.
```

### 작업 설명(Task Description)
수행해야 할 구체적인 작업과 방법을 설명

```
다음 정보를 바탕으로 사용자의 질문에 답변하세요. 여러 출처의 정보를 종합하여 일관된 응답을 
제공하고, 정보 출처를 [출처: X]와 같이 명시하세요.
```

### 검색된 컨텍스트(Retrieved Context)
검색기에서 가져온 관련 정보를 포함
```
[정보 1]
출처: 위키백과, 2024
인공지능(AI)은 인간의 학습능력, 추론능력, 지각능력을 인공적으로 구현한 컴퓨터 시스템입니다.

[정보 2]
출처: AI 개론, 2025
머신러닝은 AI의 하위 분야로, 데이터로부터 패턴을 학습하는 알고리즘을 연구합니다.
```

### 사용자 질의(User Query)
실제 사용자의 질문이나 요청
```
인공지능과 머신러닝의 차이점은 무엇인가요?
```

### 응답 형식 지정(Output Format)
원하는 응답의 형식과 구조 명시
```
다음 형식으로 답변하세요:
1. 간단한 정의 비교 (2-3문장)
2. 주요 차이점 (3-4개 요점)
3. 실제 응용 사례 비교
4. 최종 응답은 한국어로 변환 
5. 마크다운 형식으로 출력
```

### 제약 사항(Constraints)
모델이 따라야 할 제한사항
```
- 제공된 정보에 없는 내용은 추가하지 마세요.
- 불확실한 정보가 있으면 "제공된 정보만으로는 확실히 알 수 없습니다"라고 명시하세요.
- 응답은 300단어를 넘지 않아야 합니다.
```

---

## 5. 프롬프트 템플릿과 패턴

### 기본 RAG 프롬프트 템플릿

```
당신은 도움이 되고 정확한 어시스턴트입니다. 제공된 컨텍스트를 사용하여 사용자의 질의에 답변하세요.

컨텍스트:
{{검색된_컨텍스트}}

질의:
{{사용자_질의}}

지침:
- 제공된 컨텍스트만 사용하여 답변하세요.
- 컨텍스트에 정보가 없는 경우, "제공된 정보로는 답변할 수 없습니다"라고 말하세요.
- 답변에 사용한 정보의 출처를 명시하세요.
- 간결하고 명확하게 답변하세요.
```

### 출처 인용 템플릿

```
다음 정보를 바탕으로 사용자의 질문에 답변하세요:

{{검색된_컨텍스트}}

사용자 질문: {{사용자_질의}}

답변 시 다음 형식을 따르세요:
1. 질문에 직접적인 답변 제공
2. 관련 추가 정보 제공 (해당하는 경우)
3. 참고한 출처 목록 (번호 매겨서 나열)

출처를 인용할 때는 [1], [2]와 같이 괄호 안에 번호를 사용하세요.
```

### 불확실성 처리 템플릿

```
당신은 정보 검색 시스템입니다. 다음 검색 결과를 바탕으로 질문에 답하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

응답 지침:
- 확실한 정보는 자신있게 제시하세요.
- 정보가 불완전하면 "부분적으로 알 수 있는 것은..."이라고 시작하세요.
- 정보가 없으면 "제공된 정보에는 이에 대한 답변이 없습니다"라고 명시하세요.
- 추측하지 마세요.
```

### 정보 종합 템플릿

```
제공된 여러 정보 조각을 종합하여 일관된 응답을 생성하세요:

{{검색된_컨텍스트}}

사용자 질의: {{사용자_질의}}

응답 생성 지침:
1. 먼저 모든 관련 정보를 식별하세요.
2. 정보 간 충돌이 있는지 확인하세요.
3. 다양한 출처의 정보를 논리적으로 통합하세요.
4. 시간 순서나 중요도에 따라 구조화된 응답을 작성하세요.
5. 종합한 정보의 출처를 명확히 밝히세요.
```

### 전문가 페르소나 템플릿

```
당신은 {{분야}} 전문가로, 20년의 경험을 가지고 있습니다. 다음 정보를 참고하여 
초보자도 이해할 수 있도록 전문적이면서 접근하기 쉬운 답변을 제공하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

전문가로서 다음을 포함해 답변하세요:
- 핵심 개념에 대한 명확한 설명
- 실제 적용 사례 1-2개
- 초보자가 피해야 할 흔한 오해 또는 실수
```

---

## 6. 프롬프트 최적화

### 프롬프트 길이 최적화
- **토큰 한계 고려**: LLM의 컨텍스트 윈도우 제한 내에서 설계
- **중요도 기반 정보 배치**: 가장 중요한 정보를 먼저/마지막에 배치
- **정보 요약**: 검색된 컨텍스트가 너무 길 경우 핵심만 요약

### 복잡성 조절
- **단계별 분해**: 복잡한 지시를 순차적 단계로 분해
- **예시 제공**: 복잡한 요구사항에 대한 구체적 예시 추가
- **시각적 구조화**: 번호 매김, 들여쓰기, 구분선 등 사용

### 모델별 최적화
- **모델 특성 고려**: 각 LLM의 강점/약점에 맞는 프롬프트 설계
- **토큰 효율성**: 모델이 잘 이해하는 간결한 표현 사용
- **명시적 지시**: 더 작은 모델일수록 더 명시적인 지시 필요

### 반복적 개선
- **A/B 테스트**: 여러 프롬프트 변형을 테스트하여 최적 버전 선택
- **점진적 개선**: 작은 변화를 순차적으로 적용하고 효과 측정
- **사용자 피드백 반영**: 실제 사용자 반응을 바탕으로 개선

### 동적 프롬프트 생성
- **쿼리 기반 조정**: 사용자 질의 특성에 따라 프롬프트 조정
- **컨텍스트 기반 조정**: 검색된 정보 특성에 따라 프롬프트 최적화
- **메타 프롬프트**: LLM을 활용한 프롬프트 자동 생성/최적화

---

## 7. 고급 프롬프트 기법

### 체인 오브 소트(Chain-of-Thought)
여러 단계의 추론 과정을 명시적으로 요청하여 복잡한 문제 해결 능력을 향상시키는 기법

```
다음 정보를 바탕으로 질문에 단계적으로 답변하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

답변 단계:
1. 먼저 질문을 분석하고 필요한 정보를 식별하세요.
2. 검색된 정보에서 관련 사실들을 추출하세요.
3. 이 사실들을 논리적으로 연결하여 결론을 도출하세요.
4. 최종 답변을 제시하세요.

각 단계를 명시적으로 보여주며 추론 과정을 설명하세요.
```

### 자기 반성(Self-Reflection)
LLM이 자신의 응답을 검토하고 개선하도록 유도하는 기법

```
다음 컨텍스트를 바탕으로 질문에 답하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

1단계: 초기 답변 작성
2단계: 다음 기준으로 자신의 답변 평가
   - 정확성: 모든 사실이 컨텍스트에 있는가?
   - 완전성: 질문의 모든 측면을 다루었는가?
   - 논리성: 추론 과정이 논리적인가?
3단계: 필요한 경우 답변 수정
4단계: 최종 답변 제시
```

### 역할 전환(Role Switching)
다양한 관점에서 문제를 바라보도록 여러 역할을 번갈아 취하게 하는 기법

```
다음 정보에 기반하여 여러 전문가의 관점에서 질문을 분석하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

다음 역할을 차례로 맡아 답변을 제시하세요:
1. 데이터 과학자 관점: 데이터와 통계에 기반한 분석
2. 비즈니스 전략가 관점: 실용적인 응용과 비즈니스 가치
3. 윤리학자 관점: 잠재적 윤리적 고려사항
4. 종합 관점: 위 세 관점을 통합한 균형 잡힌 최종 답변
```

### 동적 검색 유도(Retrieval Guidance)
LLM에게 필요한 추가 정보를 명시하게 하여 검색 과정을 개선하는 기법

```
초기 정보:
{{검색된_컨텍스트}}

질문: {{사용자_질의}}

1단계: 위 정보로 질문에 답변 가능한지 평가하세요.
2단계: 답변하기 위해 필요하지만 누락된 정보를 구체적으로 나열하세요.
3단계: 현재 가능한 범위 내에서 질문에 답변하세요.

출력 형식:
정보 충분성 평가: [충분/부분적/불충분]
필요한 추가 정보: [구체적인 정보 목록]
현재 가능한 답변: [답변 내용]
```

### 가정 명시(Assumption Articulation)
LLM이 암묵적 가정들을 명시적으로 밝히게 하는 기법

```
다음 정보를 바탕으로 질문에 답하세요:

{{검색된_컨텍스트}}

질문: {{사용자_질의}}

응답 과정:
1. 이 질문에 답하기 위한 가정들을 나열하세요.
2. 제공된 정보에서 확인할 수 있는 가정과 없는 가정을 구분하세요.
3. 확인된 가정들에 기반하여 답변을 작성하세요.
4. 확인되지 않은 가정들이 답변에 미치는 영향을 설명하세요.
```

---

**참고 자료:**
- [프롬프트 엔지니어링] : (https://cloud.google.com/discover/what-is-prompt-engineering?hl=ko#prompt-engineering-overview-and-guide)
- [실습코드] : [LangChain 한국어 튜토리얼](https://github.com/teddylee777/langchain-kr)

